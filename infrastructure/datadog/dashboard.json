{
    "title": "Chorus: Multi-Agent Trust & Observability",
    "description": "Real-time monitoring for the Chorus Multi-Agent Immune System, featuring LLM Telemetry (Gemini), Trust Scores, and System Health.",
    "widgets": [
        {
            "definition": {
                "type": "group",
                "layout_type": "ordered",
                "title": "System Overview",
                "widgets": [
                    {
                        "definition": {
                            "type": "query_value",
                            "requests": [
                                {
                                    "q": "sum:chorus.gemini.request{env:$env}.as_count()",
                                    "aggregator": "sum"
                                }
                            ],
                            "title": "Total LLM Requests"
                        }
                    },
                    {
                        "definition": {
                            "type": "query_value",
                            "requests": [
                                {
                                    "q": "avg:chorus.conflict.risk_score{env:$env}",
                                    "aggregator": "avg"
                                }
                            ],
                            "title": "Avg Conflict Risk"
                        }
                    },
                    {
                        "definition": {
                            "type": "query_value",
                            "requests": [
                                {
                                    "q": "sum:chorus.agent.quarantined{env:$env}",
                                    "aggregator": "avg"
                                }
                            ],
                            "title": "Quarantined Agents"
                        }
                    }
                ]
            }
        },
        {
            "definition": {
                "type": "group",
                "layout_type": "ordered",
                "title": "LLM Performance & Costs (Gemini)",
                "widgets": [
                    {
                        "definition": {
                            "type": "timeseries",
                            "requests": [
                                {
                                    "q": "avg:chorus.gemini.latency{env:$env} by {model}",
                                    "display_type": "line",
                                    "style": {
                                        "palette": "cool",
                                        "line_type": "solid",
                                        "line_width": "normal"
                                    }
                                }
                            ],
                            "title": "LLM Latency (ms)"
                        }
                    },
                    {
                        "definition": {
                            "type": "timeseries",
                            "requests": [
                                {
                                    "q": "sum:chorus.gemini.tokens.total{env:$env} by {model}.as_count()",
                                    "display_type": "bars",
                                    "style": {
                                        "palette": "warm",
                                        "line_type": "solid",
                                        "line_width": "normal"
                                    }
                                }
                            ],
                            "title": "Token Usage (Total)"
                        }
                    },
                    {
                        "definition": {
                            "type": "timeseries",
                            "requests": [
                                {
                                    "q": "sum:chorus.gemini.tokens.prompt{env:$env}.as_count()",
                                    "display_type": "area"
                                },
                                {
                                    "q": "sum:chorus.gemini.tokens.completion{env:$env}.as_count()",
                                    "display_type": "area"
                                }
                            ],
                            "title": "Token Breakdown (Prompt vs Completion)"
                        }
                    }
                ]
            }
        },
        {
            "definition": {
                "type": "group",
                "layout_type": "ordered",
                "title": "Agent & Trust Analysis",
                "widgets": [
                    {
                        "definition": {
                            "type": "timeseries",
                            "requests": [
                                {
                                    "q": "avg:chorus.agent.trust_score{env:$env} by {agent_id}",
                                    "display_type": "line"
                                }
                            ],
                            "title": "Agent Trust Scores"
                        }
                    },
                    {
                        "definition": {
                            "type": "timeseries",
                            "requests": [
                                {
                                    "q": "sum:chorus.conflict.risk_score{env:$env}.as_count()",
                                    "display_type": "bars"
                                }
                            ],
                            "title": "Conflict Predictions Over Time"
                        }
                    }
                ]
            }
        },
        {
            "definition": {
                "type": "group",
                "layout_type": "ordered",
                "title": "Infrastructure & Logs",
                "widgets": [
                    {
                        "definition": {
                            "type": "timeseries",
                            "requests": [
                                {
                                    "q": "avg:system.cpu.idle{env:$env}",
                                    "display_type": "line"
                                }
                            ],
                            "title": "System CPU Idle"
                        }
                    },
                    {
                        "definition": {
                            "type": "log_stream",
                            "indexes": ["main"],
                            "query": "service:chorus-backend env:$env status:error",
                            "sort": {
                                "field": "timestamp",
                                "order": "desc"
                            }
                        }
                    }
                ]
            }
        }
    ],
    "template_variables": [
        {
            "name": "env",
            "prefix": "env",
            "default": "production"
        }
    ],
    "layout_type": "ordered"
}